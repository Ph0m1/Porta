server {
    listen 80;
    server_name localhost;

    location / {
        root /usr/share/nginx/html;
        index index.html index.htm;
        try_files $uri $uri/ =404;
    }

    location /users {
        add_header Content-Type application/json;
        return 200 '{"users": [{"id": 3, "name": "Bob Wilson", "email": "bob@example.com"}, {"id": 4, "name": "Alice Brown", "email": "alice@example.com"}], "service": "backend-2"}';
    }

    location /posts {
        add_header Content-Type application/json;
        return 200 '{"posts": [{"id": 3, "title": "Backend 2 Post", "content": "Content from backend 2"}, {"id": 4, "title": "Another Backend 2 Post", "content": "More content from backend 2"}], "service": "backend-2"}';
    }

    location /__health {
        add_header Content-Type application/json;
        return 200 '{"status": "healthy", "service": "backend-2", "timestamp": "$time_iso8601"}';
    }

    location /metrics {
        add_header Content-Type text/plain;
        return 200 '# HELP backend_requests_total Total number of requests
# TYPE backend_requests_total counter
backend_requests_total{service="backend-2"} 24
';
    }

    error_page 500 502 503 504 /50x.html;
    location = /50x.html {
        root /usr/share/nginx/html;
    }
} 